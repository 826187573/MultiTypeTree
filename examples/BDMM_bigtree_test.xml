<beast version='2.0'
       namespace='beast.core:beast.evolution.tree.coalescent:beast.core.util:
       beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:
       beast.evolution.substitutionmodel:beast.evolution.likelihood:
       beast.evolution.speciation:beast.core.parameter'>


    <parameter name="orig_root" id="orig_root" value ="1." lower="0." upper="1.7976931348623157E308"/>
    
	<parameter name="birthRate" id="birthRate" value="1.2 2.5 1.5" lower="1e-20" upper="100."/>
	<parameter name="deathRate" id="deathRate" value="1. 1. 1." lower="1e-20" upper="100."/>
	<parameter name="samplingRate" id="samplingRate" value=".02 .02 .02" lower="1e-20" upper="100."/>
 
    <tree spec='beast.util.TreeParser' id='tree2' IsLabelledNewick='true' singlechild="true" adjustTipHeights="false"> 
		<input name='newick'>
			((((((('39_0_12.47'[state='0']:2.0093404862773667, '56_0_11.81'[state='0']:1.3519753627567468)[state='0']:2.6597885902607254, ('183_0_10.27'[state='0']:1.8595550303291954, '188_0_10.15'[state='0']:1.7404059866122417)[state='0']:0.6155778161029479)[state='0']:0.27738884805652564, ((('196_0_12.61'[state='0']:2.552401742607861)[state='1']:0.9211314008477505, '212_1_11.98'[state='1']:2.8428222117179534)[state='1']:0.25853119225889465)[state='0']:1.356622461567488)[state='0']:0.6575783473552388, ((('227_0_12.32'[state='0']:1.5526636229112842)[state='2']:2.5849483131640767)[state='0']:0.3083354609488582, (('266_2_12.09'[state='2']:3.2719454470755647, '292_2_11.39'[state='2']:2.5657926430267732)[state='2']:0.1233300256032237)[state='0']:0.8276986233481027)[state='0']:1.0069044511696168)[state='0']:2.696792177483732, (('431_0_12.16'[state='0']:5.175891015330269, ('438_0_9.76'[state='0']:1.6511073379931762, ('441_2_11.72'[state='2']:2.87615807229227)[state='0']:0.7343032391138156)[state='0']:1.1234554354932076)[state='0']:1.944143300392362, '454_0_7.0'[state='0']:1.9614661312585842)[state='0']:0.8718734208402266)[state='0']:1.8512303667043906, (((('474_1_6.53'[state='1']:2.1149703514700793, ((('688_0_11.69'[state='0']:1.3515041813677549)[state='1']:4.119915110938317, ((((('829_1_12.89'[state='1']:1.8772140975201843)[state='2']:3.576675179492427)[state='0']:0.43904990936886623)[state='1']:0.3768339941172192, (('841_1_8.33'[state='1']:1.0031569838545051, ((('874_1_12.59'[state='1']:1.5813812858949508)[state='0']:0.4342357743462344)[state='2']:1.340762963685183)[state='1']:1.9013943016412318)[state='1']:0.5299447085343623, ('884_0_11.2'[state='0']:4.063114855865449)[state='1']:0.33536472688920504)[state='1']:0.18196793059549243)[state='1']:0.32964703364237646, '1010_1_11.87'[state='1']:5.581422102447066)[state='1']:0.07328931320890497)[state='1']:0.25456370717984367, ((((('1084_0_11.59'[state='0']:2.6370867990493743)[state='1']:1.217959885435297, (('1275_0_11.9'[state='0']:1.7908010875954616)[state='1']:1.2250475369569553, '1278_1_10.57'[state='1']:1.686285614166902)[state='1']:1.1479532141111033)[state='1']:0.2509417953421096, '1323_1_9.03'[state='1']:1.541781042643807)[state='1']:0.8563354246241, '1327_1_9.03'[state='1']:2.3968186454803915)[state='1']:0.09518884442301179, ('1353_1_11.3'[state='1']:3.667675163159922, ('1390_1_11.28'[state='1']:1.648152284985395, '1391_1_12.2'[state='1']:2.5683173538128816)[state='1']:1.999867544798306)[state='1']:1.0946406685100056)[state='1']:0.5726715546435308)[state='1']:1.5452529720455344)[state='1']:0.2527991797435982, ((('1456_2_7.83'[state='2']:1.1319941842876036, ((('1481_2_10.64'[state='2']:3.0679936585046113, '1490_2_9.63'[state='2']:2.0604626058634965)[state='2']:0.6883931671651444)[state='1']:0.06278647829927486)[state='2']:0.1259604001345327)[state='2']:1.296975530089381, (((('1780_1_8.59'[state='1']:1.1995844557123903, '1795_1_12.98'[state='1']:5.5854179975684435)[state='1']:0.6257268552947028, (('1925_1_12.66'[state='1']:4.223629471654352, '2058_1_12.02'[state='1']:3.585094658568144)[state='1']:0.2939250478936515, '2086_1_10.63'[state='1']:2.488369936319156)[state='1']:1.3746436798878996)[state='1']:0.14416000169029175)[state='2']:0.4101918294058917, (('2162_2_8.91'[state='2']:1.6973623229421841, (('2166_0_12.55'[state='0']:4.981359562081904)[state='2']:0.07064950386779856, (((('2263_1_12.39'[state='1']:3.0445278394218)[state='2']:0.26544326997674084, (('2392_1_12.21'[state='1']:2.457595980024127, '2395_1_13.03'[state='1']:3.274237030676124)[state='1']:0.01855843890904829)[state='2']:0.6508459766002854)[state='2']:0.2998572524472731, (((('2443_0_12.8'[state='0']:1.5145985186213267)[state='1']:1.3852858795250675)[state='2']:0.2127568585634041)[state='1']:0.7137309199803639)[state='2']:0.18991089831497554)[state='2']:0.4732361606279767, (('2562_1_10.19'[state='1']:1.4813966435798722, ((('2588_1_12.7'[state='1']:3.0099483435875047, '2614_1_12.28'[state='1']:2.5902843449352453)[state='1']:0.8591366063796801, ('2654_1_10.68'[state='1']:1.2583079303041753, '2660_1_11.85'[state='1']:2.436322675268597)[state='1']:0.5837241109367053)[state='1']:0.05211723225633236, ('2674_2_12.44'[state='2']:3.0966662201740505)[state='1']:0.5623099289283395)[state='1']:0.07623841572380385)[state='1']:0.2621300380841838)[state='2']:0.13405178982018562)[state='2']:0.8074378648730356)[state='2']:0.2860735019003622)[state='2']:0.4447474895585666, ('2707_1_10.54'[state='1']:2.4581033910960777)[state='2']:1.3164787054278406)[state='2']:0.5590096583544808)[state='2']:0.8120665053145455)[state='2']:0.3763389802232693)[state='1']:0.8587351098977232)[state='1']:0.28061811045720697)[state='0']:1.5550221624560403, (((((('2772_0_9.41'[state='0']:1.9253139584805101)[state='2']:0.6090868884526675, '2870_2_9.12'[state='2']:2.244238615756837)[state='2']:0.5280245475776972, (('3083_0_12.43'[state='0']:2.36444112838622)[state='2']:2.587278984186587, (('3246_0_13.04'[state='0']:1.8594556223560303)[state='1']:0.02050377705782047)[state='2']:3.6865407459078066)[state='2']:1.131023090404553)[state='2']:1.4310489335820868, ('3321_2_12.36'[state='2']:4.298543577126809, ((('3361_1_12.66'[state='1']:1.5687909843592696, '3363_1_13.11'[state='1']:2.019925891978396)[state='1']:1.0711912858791859)[state='0']:1.8944600193780996)[state='2']:0.06059080323070454)[state='2']:3.1487367654013134)[state='2']:0.9443742790342657, ((('3570_2_12.42'[state='2']:2.5441969626608785, '3592_2_13.01'[state='2']:3.1392231576124043)[state='2']:0.7928857472081834, '3595_2_10.7'[state='2']:1.625191026980609)[state='2']:0.6609429241703015, '3622_2_10.04'[state='2']:1.6198613680984888)[state='2']:4.446066131274973)[state='2']:0.9343219815643531)[state='0']:0.7084311925108953)[state='0']:0.013515173884616871)[state='0']:0.2408809232377327, ((((((('3738_1_10.73'[state='1']:1.994014757303093)[state='0']:0.6141481924479137, '3800_0_12.62'[state='0']:4.5057445056544605)[state='0']:1.1782757542353286, ((('3857_0_11.18'[state='0']:1.7316141394106896, '3859_0_11.16'[state='0']:1.712750523758741)[state='0']:0.07361511749786409, '3860_0_11.06'[state='0']:1.684543451018369)[state='0']:1.7910237201933565, '3994_0_10.26'[state='0']:2.673731293005229)[state='0']:0.6444653413827597)[state='0']:1.0426276485852162, ((('4022_2_12.08'[state='2']:2.4313047427927064)[state='0']:2.6619600392688447, (('4109_0_12.63'[state='0']:4.89551730884498)[state='1']:0.36502088672516475)[state='0']:0.37755092376594046)[state='0']:0.22449817262121563, '4126_0_9.29'[state='0']:2.52633493789647)[state='0']:0.8693954938326183)[state='0']:0.2580454102463161, (((((('4211_0_12.53'[state='0']:2.629515635595899)[state='1']:0.06633361500025892, '4248_1_11.87'[state='1']:2.0334471788531037)[state='1']:0.3322719328620316)[state='0']:0.27852734084797426)[state='1']:0.8929119528925149)[state='0']:2.092622807034142, ('4260_2_10.75'[state='2']:4.060940521429412)[state='0']:0.4459274735311416)[state='0']:0.6009720004489134)[state='0']:1.8678097646822636, ((((('4402_1_12.55'[state='1']:2.5247120689132707)[state='2']:0.17604694747088523)[state='0']:2.7619123832500785, ('4455_1_11.72'[state='1']:4.083657298361745)[state='0']:0.5471266909222079)[state='0']:0.2427306196430825, (('4568_2_12.77'[state='2']:3.706153858458986)[state='0']:0.8097962344098466, ('4574_1_11.16'[state='1']:2.4549513139429084)[state='0']:0.4506772423550913)[state='0']:1.4140761066552638)[state='0']:1.7913387856375467, (((('4796_1_11.48'[state='1']:4.209427410947379)[state='2']:1.4748426258185976, ((((('4985_0_11.51'[state='0']:3.8128463779323685)[state='2']:0.2926366232632729, ('5192_2_10.78'[state='2']:2.028448633411866, (('5230_0_11.43'[state='0']:1.6549688419584676)[state='1']:0.8050832098728495)[state='2']:0.22249811035277212)[state='2']:1.3433860798137678)[state='2']:0.36932242532294257, '5344_2_10.58'[state='2']:3.5447279000869685)[state='2']:0.5942754354544979, '5350_2_8.48'[state='2']:2.0358616168188712)[state='2']:0.6401527652300381, '5402_2_10.43'[state='2']:4.624692497395734)[state='2']:0.006791117684207926)[state='2']:0.6436575693317392, ((('5418_1_9.89'[state='1']:2.7392164844061035, ('5473_1_9.51'[state='1']:2.0251261025380014, '5609_1_11.11'[state='1']:3.6180575101569783)[state='1']:0.3370119216213041)[state='1']:0.37998737048457887)[state='2']:1.0784982632936169, (('5638_2_12.59'[state='2']:5.782242789638059, ('5656_0_11.52'[state='0']:2.303683719809557)[state='2']:2.4073461214553307)[state='2']:0.024553347115465307, ('5818_2_11.1'[state='2']:3.2528242730694767, '5821_2_9.89'[state='2']:2.0422335852983693)[state='2']:1.0643445704889825)[state='2']:1.08787444082634)[state='2']:0.5412716497136332)[state='2']:0.09899853694530769)[state='0']:0.003225416563640948)[state='0']:1.2803860180020736)[state='0']:0.40269878775218304, (('5851_0_6.04'[state='0']:1.7323141548744347, ((('5940_0_12.69'[state='0']:3.4029912640318507, ('5945_2_12.56'[state='2']:2.493327816595329)[state='0']:0.7804697968362113)[state='0']:2.291595231131586, ('6007_0_10.13'[state='0']:1.7486350452449173, '6022_0_11.84'[state='0']:3.459467205643886)[state='0']:1.3846257462468543)[state='0']:2.47432999723938, ((((('6055_0_11.5'[state='0']:1.6713154127971137)[state='2']:0.6037716736418481, (('6057_2_12.15'[state='2']:1.728375977400507)[state='1']:1.1649112269401396)[state='2']:0.02317858366701664)[state='2']:1.3438721711687416, '6081_2_9.42'[state='2']:1.5361163758071834)[state='2']:1.7826650153880355, (('6091_1_11.53'[state='1']:2.9589878830387004)[state='0']:2.1701819208483517)[state='2']:0.30102514292701965)[state='2']:0.621418818340369)[state='0']:0.9570120375883793)[state='0']:0.21299251146718934)[state='0']:0.9228519354564417, '6460_0_11.77'[state='0']:8.381656940303493)[state='0']:0.021597827624326715)[state='0']:1.2933109288247122)[state='0']:2.0741808199731087;
			<!--(((1[state='1']:1, (2[state='0']:.5)[state='1']:1.5)[state='1']:2)[state='0']:1, (3[state='0']:1.5, (4[state='1']:1.5)[state='0']:1 )[state='0']:2)[state='0']:1;
			-->
		</input>
	</tree>
    
	    
    <run spec="MCMC" id="mcmc" chainLength="100000"> 

        <init spec='beast.evolution.tree.ColouredTreeFromNewick' id="colouredTree" tree="@tree" colouredNewick="@tree2" 
        		colourLabel="state" nColours="3" maxBranchColours="3">
        	<changeColours id="tree.cols" spec="IntegerParameter" value="0"/>
        	<changeTimes id="tree.times"  spec="RealParameter" value="0."/>
        	<changeCounts id="tree.counts" spec="IntegerParameter" value="0"/>
        	<nodeColours id="tree.nodecols" spec="IntegerParameter" value="0"/>
        </init>
      
        <state>
        <!--
        	<stateNode idref="birthRate"/>
        	<stateNode idref="deathRate"/>
        	<stateNode idref="samplingRate"/>
        	<stateNode idref="orig_root"/>
        	-->
        	<stateNode idref="tree.cols"/>
        	<stateNode idref="tree.times"/>
        	<stateNode idref="tree.counts"/>
        	<stateNode idref="tree.nodecols"/>
            <stateNode spec="beast.evolution.tree.Tree" id="tree"/>
        	<stateNode idref="mu"/>
        </state>
        

        <distribution spec="CompoundDistribution" id="prior">
   			 <distribution spec="beast.evolution.speciation.BirthDeathMigrationModel" id="BDMM" orig_root='@orig_root' 
   			 		birthRate='@birthRate' deathRate='@deathRate' samplingRate='@samplingRate' tree='@tree' 
   			 		stateNumber="3" colouredTree="@colouredTree">
   			 	<parameter name="migrationMatrix" value=".05 .03 .01 .03 .01 .03"/>
   			 	<parameter name="frequencies" value=".333333 .3333335 .3333335"/>
   			 </distribution>
        </distribution>

	  	<operator spec='beast.evolution.operator.ColouredWilsonBaldingRandom' id="CWBR" weight="1" tree="@tree" colouredTree='@colouredTree'>
				<parameter name='mu' id="mu" value="1."/>
		</operator>
		<!--
	  	<operator spec='ScaleOperator' id="TreeScaler" weight="100" scaleFactor="0.95" tree="@tree" />
	  	<operator spec='ScaleOperator' id="RootScaler" weight="1" scaleFactor="0.95" tree="@tree" rootOnly="true"/>
	-->
        <logger logEvery="100" fileName="BDMM_bigtree.log">
   	        <model idref='prior'/>
            <log idref="prior"/>
        	<log idref="birthRate"/>
        	<log idref="deathRate"/>
			<log idref="samplingRate"/>
			<log idref="orig_root"/>
            <log spec='beast.evolution.tree.TreeHeightLogger'>
            	<tree idref="tree"/>
            </log>
        </logger>
        
        <logger logEvery="100" fileName="BDMM_bigtree.trees">
            <log idref="tree"/>
        </logger>
        
        <logger logEvery="100" fileName="BDMM_bigtree_col.trees" mode="tree">
            <log idref="colouredTree"/>
        </logger>
        
        <logger logEvery="100">
	        <model idref='prior'/>
            <log idref="prior"/>
            <log idref="birthRate"/>
            <log idref="deathRate"/>
			<log idref="samplingRate"/>
			<log idref="orig_root"/>
            <log spec='beast.evolution.tree.TreeHeightLogger' >
            	<tree idref="tree"/>
            </log>
        </logger>
        
        <!--
        <logger spec="beast.evolution.tree.TreeReport" id="treeReporter">
            <log idref="tree"/>
        </logger>
        -->
       
    </run>

</beast>
