<beast version='2.0'
       namespace='beast.core:beast.evolution.tree.coalescent:beast.core.util:
       beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:
       beast.evolution.substitutionmodel:beast.evolution.likelihood:
       beast.evolution.speciation:beast.core.parameter'>


	<tree spec='beast.util.TreeParser' id='tree2' IsLabelledNewick='true'
		singlechild="true" adjustTipHeights="false"> 

	<input name='newick'>

		((1[state='0']:1,2[state='0']:1)[state='0']:1,(3[state='0']:1,4[state='0']:1)[state='0']:1)[state='0']:0;


<!--(((1[state='1']:1, (2[state='0']:.5)[state='1']:1.5)[state='1']:2)[state='0']:1, (3[state='0']:1.5, (4[state='1']:1.5)[state='0']:1 )[state='0']:2)[state='0']:1;-->
	</input>

	</tree>

	<model spec='beast.evolution.migrationmodel.MigrationModel' id="migmodel">
		<rateMatrix spec='RealParameter' value="0 1 1 0" minordimension="2"/>
		<popSizes spec="RealParameter" value="5 5"/>
	</model>
    
	    
    <run spec="MCMC" id="mcmc" chainLength="200000"> 

		<init spec='beast.evolution.tree.ColouredTreeFromNewick'
			id="colouredTree" tree="@tree" colouredNewick="@tree2" 
   	     		colourLabel="state" nColours="2" maxBranchColours="20">
   	     	<changeColours id="tree.cols" spec="IntegerParameter" value="0"/>
        	<changeTimes id="tree.times"  spec="RealParameter" value="0."/>
        	<changeCounts id="tree.counts" spec="IntegerParameter" value="0"/>
        	<nodeColours id="tree.nodecols" spec="IntegerParameter" value="0"/>
	</init>
      
		<state>
			<stateNode idref="tree.cols"/>
   			<stateNode idref="tree.times"/>
			<stateNode idref="tree.counts"/>
			<stateNode idref="tree.nodecols"/>
			<stateNode spec="beast.evolution.tree.Tree" id="tree"/>
			<stateNode spec="RealParameter" value="1.0" id="mu"/>
		</state>
        
		<distribution spec="CompoundDistribution" id="prior">

			<distribution id='scLikelihood' spec="StructuredCoalescentLikelihood">
				<migrationModel idref="migmodel"/>
				<colouredTree idref="colouredTree"/>
			</distribution>

		</distribution>

		<operator spec='beast.evolution.operator.ColouredWilsonBaldingRandom' id="CWBR"
			weight="1" tree="@tree" colouredTree='@colouredTree' mu="@mu"/>

		<logger logEvery="100" fileName="colouredWBtest.log">
			<model idref='prior'/>
			<log idref="prior"/>
			<log spec='beast.evolution.tree.TreeHeightLogger'>
				<tree idref="tree"/>
			</log>
		</logger>

		<logger logEvery="100" fileName="colouredWBtest.trees">
			<log idref="tree"/>
		</logger>  

		<logger logEvery="100" fileName="colouredWBtest_col.trees" mode="tree">
			<log idref="colouredTree"/>
		</logger>

		<logger logEvery="100">
			<model idref='prior'/>
			<log idref="prior"/>
			<log spec='beast.evolution.tree.TreeHeightLogger' >
				<tree idref="tree"/>
			</log>
		</logger>

		<logger spec="beast.evolution.tree.TreeReport" id="treeReporter" >
			<log idref="tree"/>
		</logger>

	</run>

</beast>
