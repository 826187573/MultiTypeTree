<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>MultiTypeTree by CompEvol</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width,
    initial-scale=1, user-scalable=no">

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-44492203-2', 'compevol.github.io');
      ga('send', 'pageview');
    </script>

    <style>
      pre {
      color: white;
      }
    </style>

  </head>
  <body>

      <header>
        <h1>MultiTypeTree</h1>
        <p>Structured population inference for BEAST 2</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

	<a href="https://github.com/CompEvol/MultiTypeTree/releases"
	class="button"><strong>Latest Release</strong></a>

        <div class="downloads">
	  <!--          <span>Downloads:</span>-->
	  <ul>
	    <!-- <li><a href="https://github.com/CompEvol/MultiTypeTree/zipball/master" class="button">Wiki</a></li>-->
	    <li><a href="https://github.com/CompEvol/MultiTypeTree" class="button">Source code</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>

	<img align="right" src="images/SCtree.svg"/>

	<h2>Overview</h2>

        <p>MultiTypeTree is a <a href="http://beast2.org/">BEAST 2</a>
          package for performing phylogenetic inference under models
          incorporating some form of population structure.  It
          implements a "multi-type" tree object, representing a
          phylogenetic tree with every time on each edge associated
          with one of a finite number of discrete types.  These types
          often represent locations, but can in principle represent
          any well-defined sub-population.</p>

	<p>In addition to the basic object, MultiTypeTree implements a
	  full suite of proposal operators for these objects, as well
	  as the structured coalescent probability density and a
	  structured coalescent simulator.  Together, these components
	  allow for inference of trees, migration rates and population
	  sizes under the structured coalescent model.  However, we
	  stress that the system can (and will) be easily extended to
	  cope with other structured-population genealogical
	  models.</p>

	<h2>Getting Started</h2>
	
	<p>Being a BEAST 2 package, installation of MultiTypeTree is
	in general quite straight-forward.  One temporary
	complication, however, is that the package currently depends
	on BEAST 2 features which have not yet been incorporated into
	the current BEAST 2 binary release (2.0.2). Thus, both of the
	following files are required:
	<ul>
	  <li>The latest release
	  of <a href="https://github.com/CompEvol/MultiTypeTree/releases">MultiTypeTree</a>.
	  <li>A pre-release of <a href="binaries/BEAST2.0.3_pre.zip">BEAST 2.0.3</a>.
	</ul>
	</p>

	<p>Once you have downloaded these files, you will need to
	<ol>
	  <li>Unzip <code>BEAST2.0.3_pre.zip</code>, which will result
	    in a new folder <kbd>BEAST2.0.3_pre/</kbd></li>
	  <li>Move the package
	    file <code>MultiTypeTree-x.y.z.zip</code> into this new
	    folder and unzip it.</li>
	</ol>
	</p>

	<p>At this point, BEAST can be executed by opening the
	  folder <kbd>BEAST2.0.3_pre/</kbd> and double-clicking on the
	  file <code>beast2.jar</code>. This will bring up a dialog
	  box where a BEAST 2 XML file can be selected. Mac OS X and
	  Linux users can alternatively use the command
	  <pre>java -jar beast2.jar filename.xml</pre>
	  to execute BEAST with the XML input
	  file <code>filename.xml</code> from the command line.</p>

	<p>Note that <a href="http://www.java.com">Java</a> is
	  required to run BEAST.</p>

	<h2>Tutorial: Structured coalescent analysis</h2>
	<p>The MultiTypeTree package is not yet equipped with a BEAUTi
	  graphical interface.  Therefore, analyses are set up by
	  working directly on the BEAST 2 XML input file.  In
	  practice, the best way to do this is to modify the example
	  XML <code>structuredCoalescent.xml</code> provided in
	  the <kbd>examples/</kbd> subdirectory of the MultiTypeTree
	  package archive.  We will give a brief overview of this
	  procedure here, when the goal is to analyze a single
	  serially-sampled sequence alignment under a structured
	  coalescent D locations and an HKY substitution model.  <i>We
	  recommend that you have a copy of the example file open in a
	  text editor when reading these instructions.</i></p>

	<p>Firstly, incorporate the sequence data corresponding to the
	  alignment using the <code>&lt;sequence&gt;</code> elements
	  within the <code>&lt;alignment&gt;</code> element, ensuring
	  the <code>taxon</code> attribute of each sequence is
	  correctly specified.</p>

	<p>Secondly, include the locations and times corresponding to
	  each of the sampled sequences by making the appropriate
	  replacements in the body of
	  the <code>&lt;typeTraitSet&gt;</code>
	  and <code>&lt;timeTraitSet&gt;</code> elements.  Note that
	  the locations must be represented as integers between 0 and
	  D-1, where "D" is the number of types in the model.  In the
	  example file, the attribute <code>traitname="time"</code>
	  causes the times to represent <i>ages</i> of leaf nodes.  By
	  using <code>traitname="date-forward"</code>, calendar years
	  or other forward-time units can be used. Note that the taxon
	  names in these elements must match those used to identify
	  the sequences.</p>

	<p>Thirdly, the initial migration model must be defined using
	  the <code>&lt;migrationModel&gt;</code> element.  Most
	  importantly, the number of migration rates and population to
	  estimate must be defined by setting the
	  respective <code>dimension="x"</code> attributes. The number
	  of rates will be D*(D-1), while the number of population
	  sizes will be D.  These same attributes must be set within
	  the <code>&lt;migrationModel&gt;</code> element which occurs
	  further along in the file, together with
	  the <code>nTypes</code> attribute of the
	  enclosing <code>&lt;init&gt;</code> element.</p>

	<p>Fourthly, the priors on the parameters must be defined. In
	  the example log-normal distributions with &mu;=0 and
	  &sigma;=4 are used for the mutation rate, migration rates
	  and population sizes.  However, these should be changed to
	  reflect your prior knowledge.</p>

	<p>Finally, the length of the MCMC chain to run should be
	  specified using the <code>chainLength</code> attribute of
	  the <code>&lt;run&gt;</code> element, and the sampling
	  period for the state logs should be defined using
	  the <code>logEvery</code> attributes of
	  the <code>&lt;logger&gt;</code> elements.</p>

	<p>Once the XML is complete, you can start your analysis by
	  executing BEAST on the input file, as specified in the
	  Getting Started section.  This will generate the
	  files <code>structuredCoalescent.log</code>
	  and <code>structuredCoalescent.trees</code>. The former can
	  be processed
	  using <a href="http://tree.bio.ed.ac.uk/software/tracer/">Tracer</a>
	  and contains the sampled parameters, while the latter
	  contains the sampled multi-type trees which can be
	  visualized using
	  either <a href="http://tree.bio.ed.ac.uk/software/figtree/">Figtree</a>
	  or <a href="http://tgvaughan.github.com/phylo.js/icytree.html">IcyTree</a>.</p>
	

	<center>
	  <a href="http://www.allanwilsoncentre.ac.nz/"><img src="images/AWC_logo.png"/></a>
	  <br/>
	  <p>Work on this project is made possible by generous funding from the<br/>
	    <a href="http://www.allanwilsoncentre.ac.nz/">Allan Wilson
	      Centre for Molecular Ecology and Epidemiology</a>.</p>
	</center>

      </section>
      <footer>
        <p>Project maintained by members
        of <a href="https://github.com/CompEvol">The University of
        Auckland Computational Evolution Group </a></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
