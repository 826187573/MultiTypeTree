<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>MultiTypeTree by CompEvol</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width,
    initial-scale=1, user-scalable=no">

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-44492203-2', 'compevol.github.io');
      ga('send', 'pageview');
    </script>

    <style>
      pre {
      color: white;
      }
    </style>

  </head>
  <body>

      <header>
        <h1>MultiTypeTree</h1>
        <p>Structured population inference for BEAST 2</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

	<a href="https://github.com/CompEvol/MultiTypeTree/releases"
	class="button"><strong>Latest Release</strong></a>

        <div class="downloads">
	  <!--          <span>Downloads:</span>-->
	  <ul>
	    <!-- <li><a href="https://github.com/CompEvol/MultiTypeTree/zipball/master" class="button">Wiki</a></li>-->
	    <li><a href="https://github.com/CompEvol/MultiTypeTree" class="button">Source code</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>

	<img align="right" src="images/SCtree.svg"/>

	<h2>Overview</h2>

        <p>MultiTypeTree is a <a href="http://beast2.org/">BEAST 2</a>
          package for performing phylogenetic inference under models
          incorporating some form of population structure.  It
          implements a "multi-type" tree object, representing a
          phylogenetic tree with every time on each edge associated
          with one of a finite number of discrete types.  These types
          often represent locations, but can in principle represent
          any well-defined sub-population.</p>

	<p>In addition to the basic object, MultiTypeTree implements a
	  full suite of proposal operators for these objects, as well
	  as the structured coalescent probability density and a
	  structured coalescent simulator.  Together, these components
	  allow for inference of trees, migration rates and population
	  sizes under the structured coalescent model.  However, we
	  stress that the system can (and will) be easily extended to
	  cope with other structured-population genealogical
	  models.</p>

	<h2>Getting started</h2>
	
	<p>To get the MultiTypeTree package running on your computer,
	follow these steps:</p>

	<ol>
	  <li>Download and install the latest version of BEAST 2 from
	    <a href="http://www.beast2.org/">www.beast2.org</a> if you
	    haven't done so already.</li>
	  <li>Run the BEAUti program that comes with BEAST and select
	  "Manage Packages" from the "File" menu.</li>
	  <li>Select "MultiTypeTree" from the list and press the
	  "Install/Upgrade" button.</li>
	  <li>Press the <kbd>?</kbd> button (lower right-hand corner)
	  and take note of the directory reported here - this is where
	  the package is installed on your disk and is where the
	  example script used in the next section is located.</li>
	</ol>

	<p>Congratulations! MultiTypeTree is now installed.  You
	should now be able to run MultiTypeTree analyses in BEAST.</p>

        <p><b>Note: BEAST 2 XML scripts written for versions of
            MultiTypeTree earlier than 3.0.0 will not run without
            modification on version 3 or later.  To get these scripts
            to run, simply append the following to the value of
            the <code>namespace</code> attribute of
            the <code>&lt;beast&gt;</code> element at the top of the
            file:</b>
          <code>:multitypetree.distributions:multitypetree.operators:multitypetree.util</code></p>

	<h2>Tutorial: Structured coalescent analysis</h2>
	<p>The MultiTypeTree package is not yet equipped with a BEAUti
	  graphical interface.  Therefore, analyses are set up by
	  working directly on the BEAST 2 XML input file.  In
	  practice, the best way to do this is to modify the example
	  XML <code>structuredCoalescent.xml</code>.  (This file can be
	  found in the <kbd>MultiTypeTree/examples</kbd> directory
	  that is located in the folder described at the end of the
	  previous section. It can also be downloaded directly from
	  <a href="https://raw.githubusercontent.com/CompEvol/MultiTypeTree/master/examples/structuredCoalescent.xml">here</a>.)</p>

	  <p>We will give a brief overview of the modification
	  procedure here, when the goal is to analyze a single
	  serially-sampled sequence alignment under a structured
	  coalescent model with D distinct locations and an HKY
	  substitution model.  <i>We recommend that you have a copy of
	  the example file open in a text editor when reading these
	  instructions.</i></p>

	<p>Firstly, incorporate the sequence data corresponding to the
	  alignment using the <code>&lt;sequence&gt;</code> elements
	  within the <code>&lt;alignment&gt;</code> element, ensuring
	  the <code>taxon</code> attribute of each sequence is
	  correctly specified.</p>

	<p>Secondly, include the locations and times corresponding to
	  each of the sampled sequences by making the appropriate
	  replacements in the body of
	  the <code>&lt;typeTraitSet&gt;</code>
	  and <code>&lt;timeTraitSet&gt;</code> elements.  Note that
	  the locations must be identified by no more than D unique
	  strings or numbers, where "D" is the number of types in the model.  In the
	  example file, the attribute <code>traitname="date-backward"</code>
	  causes the times to represent <i>ages</i> of leaf nodes.  By
	  using <code>traitname="date-forward"</code>, calendar years
	  or other forward-time units can be used. Note that the taxon
	  names in these elements must match those used to identify
	  the sequences.</p>

	<p>Thirdly, the initial migration model must be defined using
	  the <code>&lt;migrationModel&gt;</code> element.  Most
	  importantly, the number of migration rates and population to
	  estimate must be defined by setting the
	  respective <code>dimension="x"</code> attributes. The number
	  of rates will be D*(D-1), while the number of population
	  sizes will be D.  These same attributes must be set within
	  the <code>&lt;migrationModel&gt;</code> element which occurs
	  further along in the file, together with
	  the <code>nTypes</code> attribute of the
	  enclosing <code>&lt;init&gt;</code> element.</p>

	<p>Fourthly, the priors on the parameters must be defined. In
	  the example log-normal distributions with &mu;=0 and
	  &sigma;=4 are used for the mutation rate, migration rates
	  and population sizes.  However, these should be changed to
	  reflect your prior knowledge.</p>

	<p>Finally, the length of the MCMC chain to run should be
	  specified using the <code>chainLength</code> attribute of
	  the <code>&lt;run&gt;</code> element, and the sampling
	  period for the state logs should be defined using
	  the <code>logEvery</code> attributes of
	  the <code>&lt;logger&gt;</code> elements.</p>

	<p>Once the XML is complete, you can start your analysis by
	  executing BEAST on the input file, as specified in the
	  README.txt file distributed with BEAST 2.  This will
	  generate the files <code>structuredCoalescent.log</code>
	  and <code>structuredCoalescent.trees</code>. The former can
	  be processed
	  using <a href="http://tree.bio.ed.ac.uk/software/tracer/">Tracer</a>
	  and contains the sampled parameters, while the latter
	  contains the sampled multi-type trees which can be
	  visualized using
	  either <a href="http://tree.bio.ed.ac.uk/software/figtree/">Figtree</a>
	  or <a href="http://tgvaughan.github.com/icytree/icytree.html">IcyTree</a>.</p>
	

	<center>
	  <a href="http://www.allanwilsoncentre.ac.nz/"><img src="images/AWC_logo.png"/></a>
	  <br/>
	  <p>Work on this project is made possible by generous funding from the<br/>
	    <a href="http://www.allanwilsoncentre.ac.nz/">Allan Wilson
	      Centre for Molecular Ecology and Evolution</a>.</p>
	</center>

      </section>
      <footer>
        <p>Project maintained by members
        of <a href="https://github.com/CompEvol">The University of
        Auckland Computational Evolution Group </a></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
